"""
Some helpful data transformations for the MIST-format
"""

class CategoryOperationTransform(object):
    """
    This transform just returns the category and operation part of the trace as feature.
    It is useful for making the baseline model.
    """

    def __init__(self):
        pass

    def __call__(self, sample):
        
        # get all the cat/ops identifiers, they are in position 0 and 1 
        # in each command

        cat_ops_list = []

        for cmd in sample['trace']:
            
            cmd_parts = cmd.split(' ') 
            cat, op = cmd_parts[0], cmd_parts[1]

            cat_ops_list.append( (cat, op) )

        return { 'trace': cat_ops_list, 'label': sample['label'] }


